var path=require("path"),potty=require("potty"),os=require("os"),fs=require("fs"),child_process=require("child_process"),locker=require("proper-lockfile");process.env.ELECTRON_RUN_AS_NODE||(process.env.ELECTRON_RUN_AS_NODE=!0,child_process.spawn(process.argv[0],[__filename],{detached:!0,stdio:["inherit","inherit","inherit"]}),require("electron").app.exit(0));var rain_path={root:path.resolve(os.homedir(),".rain")};rain_path.lockfile=path.resolve(rain_path.root,"singleton.lock"),fs.existsSync(rain_path.root)||fs.mkdirSync(rain_path.root),fs.openSync(rain_path.lockfile,"w");var pot;locker.lock(rain_path.lockfile,function(e){e?process.exit():(pot=new potty(path.resolve(process.env.HOME||process.env.HOMEPATH,".rain"),"https://rain.vg/releases/desktop-daemon/"+os.type().toLowerCase()+"-"+os.arch().toLowerCase()+"/production/package",{ELECTRON_RUN_AS_NODE:!1,log:console.log}),pot.on("shutdown",function(){process.exit()}),pot.start())}),process.once("SIGINT",function(){process.exit()}).once("SIGTERM",function(){process.exit()});